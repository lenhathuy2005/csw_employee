<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>‚ú® Employee Web Service Demo ‚ú®</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            /* N·ªÅn gradient nhi·ªÅu m√†u */
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 25%, #a1c4fd 50%, #c2ffd8 75%, #fbc2eb 100%);
            color: #0f172a;
            display: flex;
            justify-content: center;
        }

        .app-container {
            width: 100%;
            max-width: 980px;
            margin: 32px 16px;
        }

        /* HEADER */

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 18px;
            padding: 18px 20px;
            border-radius: 18px;
            /* Glassmorphism */
            background: rgba(255,255,255,0.72);
            backdrop-filter: blur(14px);
            border: 1px solid rgba(255,255,255,0.9);
            box-shadow: 0 14px 35px rgba(15,23,42,0.25);
        }

        .app-title-block {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .app-icon {
            width: 40px;
            height: 40px;
            border-radius: 999px;
            background: conic-gradient(from 180deg, #fb7185, #fb923c, #facc15, #4ade80, #38bdf8, #a855f7, #fb7185);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 18px rgba(15,23,42,0.35);
        }

        .app-icon span {
            font-size: 22px;
        }

        .app-title-text {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .app-title {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: 0.02em;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .app-title .tag {
            padding: 2px 10px;
            border-radius: 999px;
            font-size: 11px;
            background: linear-gradient(135deg, #6366f1, #ec4899);
            color: #fff;
        }

        .subtitle {
            font-size: 13px;
            color: #6b7280;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(15,23,42,0.8);
            color: #e5e7eb;
            font-size: 12px;
        }

        .pill-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: #22c55e;
            box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.35);
        }

        /* CARD */

        .card {
            background: rgba(255,255,255,0.96);
            border-radius: 18px;
            padding: 20px 20px 18px;
            margin-bottom: 20px;
            box-shadow: 0 18px 40px rgba(15,23,42,0.25);
            border: 1px solid rgba(255,255,255,0.9);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top left, rgba(244,114,182,0.28), transparent 55%),
            radial-gradient(circle at bottom right, rgba(56,189,248,0.25), transparent 55%);
            opacity: 0.7;
            pointer-events: none;
        }

        .card-inner {
            position: relative;
            z-index: 1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-title span.emoji {
            font-size: 20px;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 11px;
            background: linear-gradient(135deg, #22c55e, #14b8a6);
            color: #f9fafb;
            box-shadow: 0 4px 10px rgba(22,163,74,0.35);
        }

        .badge small {
            background: rgba(15,23,42,0.2);
            padding: 1px 6px;
            border-radius: 999px;
            font-size: 10px;
        }

        /* BUTTONS */

        button {
            border: none;
            padding: 8px 14px;
            border-radius: 999px;
            background: linear-gradient(135deg, #6366f1, #ec4899);
            color: #fff;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.15s ease;
            box-shadow: 0 6px 14px rgba(99,102,241,0.35);
        }

        button:hover {
            transform: translateY(-1px) scale(1.01);
            box-shadow: 0 10px 24px rgba(99,102,241,0.45);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 4px 10px rgba(79,70,229,0.45);
        }

        button.secondary {
            background: linear-gradient(135deg, #e5e7eb, #d1d5db);
            color: #111827;
            box-shadow: 0 4px 10px rgba(148,163,184,0.45);
        }

        button.secondary:hover {
            box-shadow: 0 8px 18px rgba(148,163,184,0.55);
        }

        .button-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* TABLE */

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
            font-size: 14px;
            border-radius: 14px;
            overflow: hidden;
        }

        th, td {
            padding: 9px 12px;
            text-align: left;
        }

        thead {
            background: linear-gradient(90deg, #4f46e5, #ec4899);
            color: #f9fafb;
        }

        th {
            font-weight: 600;
            font-size: 13px;
        }

        tbody tr:nth-child(odd) {
            background: rgba(249,250,251,0.96);
        }

        tbody tr:nth-child(even) {
            background: rgba(239,246,255,0.96);
        }

        tbody tr:hover td {
            background: rgba(254,242,242,0.9);
            transition: background 0.12s ease;
        }

        td .salary-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 3px 10px;
            border-radius: 999px;
            background: rgba(22,163,74,0.08);
            color: #15803d;
            font-size: 13px;
        }

        td .salary-chip span.dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: #22c55e;
        }

        td .delete-btn {
            padding: 4px 10px;
            font-size: 13px;
            background: linear-gradient(135deg, #fb7185, #f97316);
            box-shadow: 0 4px 10px rgba(248,113,113,0.5);
        }

        /* GRID FORM */

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
            margin-top: 10px;
        }

        .panel {
            padding: 10px 12px 12px;
            border-radius: 14px;
            background: rgba(255,255,255,0.92);
            border: 1px solid rgba(226,232,240,0.9);
            box-shadow: 0 10px 25px rgba(148,163,184,0.4);
        }

        .panel h4 {
            margin: 0 0 8px;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .panel h4 span {
            font-size: 17px;
        }

        .field {
            margin-bottom: 10px;
        }

        label {
            display: block;
            font-size: 12px;
            margin-bottom: 4px;
            color: #475569;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        input {
            width: 100%;
            padding: 8px 11px;
            border-radius: 10px;
            border: 1px solid #d1d5db;
            font-size: 14px;
            outline: none;
            background: rgba(248,250,252,0.9);
            transition: all 0.15s ease;
        }

        input:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 1px rgba(129,140,248,0.6), 0 0 0 6px rgba(191,219,254,0.7);
            background: #ffffff;
        }

        /* STATUS BAR */

        .status-bar {
            margin-top: 12px;
            font-size: 13px;
            min-height: 20px;
            padding: 6px 10px;
            border-radius: 999px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(15,23,42,0.02);
        }

        .status-bar::before {
            content: "‚Ä¢";
            font-size: 18px;
        }

        .status--success {
            color: #166534;
            background: rgba(22,163,74,0.08);
        }
        .status--success::before {
            color: #22c55e;
        }

        .status--error {
            color: #b91c1c;
            background: rgba(248,113,113,0.08);
        }
        .status--error::before {
            color: #f97316;
        }

        .status--info {
            color: #0369a1;
            background: rgba(59,130,246,0.08);
        }
        .status--info::before {
            color: #38bdf8;
        }

        /* PAGINATION */

        .pagination {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 6px;
            margin-top: 10px;
            font-size: 12px;
        }

        .page-btn {
            min-width: 28px;
            padding: 5px 8px;
            border-radius: 999px;
            border: none;
            background: rgba(15,23,42,0.06);
            color: #0f172a;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.12s ease;
        }

        .page-btn:hover {
            background: rgba(59,130,246,0.15);
            transform: translateY(-1px);
        }

        .page-btn.active {
            background: linear-gradient(135deg, #6366f1, #22c55e);
            color: #f9fafb;
            box-shadow: 0 4px 10px rgba(79,70,229,0.55);
        }

        .page-ellipsis {
            padding: 0 4px;
            color: #4b5563;
        }

        @media (max-width: 640px) {
            .app-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>

<body>
<div class="app-container">
    <header class="app-header">
        <div class="app-title-block">
            <div class="app-icon">
                <span>üë®‚Äçüíª</span>
            </div>
            <div class="app-title-text">
                <div class="app-title">
                    Employee Web Service
                    <span class="tag">REST ‚Ä¢ JSON ‚Ä¢ MySQL</span>
                </div>
                <div class="subtitle">ƒê·ªÅ CSW ‚Äì Demo get / add / update / delete Employee</div>
            </div>
        </div>
        <div class="pill">
            <span class="pill-dot"></span>
            <span>Server: <strong>localhost:8080</strong></span>
        </div>
    </header>

    <!-- DANH S√ÅCH NH√ÇN VI√äN -->
    <section class="card">
        <div class="card-inner">
            <div class="card-header">
                <div class="card-title">
                    <span class="emoji">üìã</span>
                    Danh s√°ch nh√¢n vi√™n
                </div>
                <div class="button-row">
                    <button onclick="loadEmployees()">üîÑ T·∫£i danh s√°ch</button>
                    <button class="secondary" onclick="clearTable()">üßπ X√≥a hi·ªÉn th·ªã</button>
                </div>
            </div>

            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>T√™n nh√¢n vi√™n</th>
                    <th>L∆∞∆°ng</th>
                    <th>X√≥a</th>
                </tr>
                </thead>
                <tbody id="employee-table-body">
                <tr>
                    <td colspan="4" style="text-align:center; color:#9ca3af;">
                        Ch∆∞a c√≥ d·ªØ li·ªáu ‚Äì b·∫•m ‚ÄúT·∫£i danh s√°ch‚Äù.
                    </td>
                </tr>
                </tbody>
            </table>

            <div id="pagination" class="pagination"></div>

            <div id="status-list" class="status-bar status--info">
                ƒêang ch·ªù thao t√°c‚Ä¶
            </div>
        </div>
    </section>

    <!-- FORM TH√äM / C·∫¨P NH·∫¨T -->
    <section class="card">
        <div class="card-inner">
            <div class="card-header">
                <div class="card-title">
                    <span class="emoji">‚öôÔ∏è</span>
                    Th√™m / C·∫≠p nh·∫≠t nh√¢n vi√™n
                </div>
                <span class="badge">
                    API
                    <small>POST / PUT / DELETE /api/employees</small>
                </span>
            </div>

            <div class="grid">

                <!-- FORM TH√äM -->
                <div class="panel">
                    <h4><span>‚ûï</span> Th√™m m·ªõi</h4>
                    <div class="field">
                        <label for="add-id">ID *</label>
                        <input id="add-id" type="number" placeholder="V√≠ d·ª•: 1" />
                    </div>
                    <div class="field">
                        <label for="add-name">T√™n *</label>
                        <input id="add-name" type="text" placeholder="V√≠ d·ª•: Nguyen Van A" />
                    </div>
                    <div class="field">
                        <label for="add-salary">L∆∞∆°ng *</label>
                        <input id="add-salary" type="number" step="0.01" placeholder="V√≠ d·ª•: 1000" />
                    </div>
                    <button onclick="addEmployee()">‚ûï Th√™m nh√¢n vi√™n</button>
                </div>

                <!-- FORM C·∫¨P NH·∫¨T -->
                <div class="panel">
                    <h4><span>‚úèÔ∏è</span> C·∫≠p nh·∫≠t</h4>
                    <div class="field">
                        <label for="upd-id">ID c·∫ßn s·ª≠a *</label>
                        <input id="upd-id" type="number" placeholder="Nh·∫≠p ID ƒë√£ t·ªìn t·∫°i" />
                    </div>
                    <div class="field">
                        <label for="upd-name">T√™n m·ªõi *</label>
                        <input id="upd-name" type="text" placeholder="T√™n m·ªõi" />
                    </div>
                    <div class="field">
                        <label for="upd-salary">L∆∞∆°ng m·ªõi *</label>
                        <input id="upd-salary" type="number" step="0.01" placeholder="L∆∞∆°ng m·ªõi" />
                    </div>
                    <button onclick="updateEmployee()">üíæ L∆∞u c·∫≠p nh·∫≠t</button>
                </div>

            </div>

            <div id="status-form" class="status-bar status--info">
                ƒêi·ªÅn ƒë·∫ßy ƒë·ªß c√°c tr∆∞·ªùng * r·ªìi b·∫•m Th√™m / C·∫≠p nh·∫≠t.
            </div>
        </div>
    </section>
</div>


<script>
    const baseUrl = '/api/employees';
    let employeesData = [];
    let currentPage = 1;
    const pageSize = 5;
    const maxPageButtons = 3;

    function setStatusList(message, type = 'info') {
        const status = document.getElementById('status-list');
        status.textContent = message;
        status.className = 'status-bar status--' + type;
    }

    function setStatusForm(message, type = 'info') {
        const status = document.getElementById('status-form');
        status.textContent = message;
        status.className = 'status-bar status--' + type;
    }

    function renderEmployees(page = 1) {
        const tbody = document.getElementById('employee-table-body');
        tbody.innerHTML = '';

        if (!employeesData || employeesData.length === 0) {
            tbody.innerHTML = `
              <tr>
                <td colspan="4" style="text-align:center; color:#9ca3af;">
                  Kh√¥ng c√≥ nh√¢n vi√™n n√†o trong h·ªá th·ªëng.
                </td>
              </tr>`;
            document.getElementById('pagination').innerHTML = '';
            return;
        }

        const totalPages = Math.ceil(employeesData.length / pageSize);
        if (page < 1) page = 1;
        if (page > totalPages) page = totalPages;
        currentPage = page;

        const startIndex = (page - 1) * pageSize;
        const endIndex = startIndex + pageSize;
        const pageItems = employeesData.slice(startIndex, endIndex);

        pageItems.forEach(emp => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${emp.id}</td>
                <td>${emp.name}</td>
                <td>
                    <span class="salary-chip">
                        <span class="dot"></span>
                        ${emp.salary}
                    </span>
                </td>
                <td>
                    <button class="delete-btn"
                            onclick="deleteEmployee(${emp.id})">
                        üóë X√≥a
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        });

        const remaining = pageSize - pageItems.length;
        for (let i = 0; i < remaining; i++) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td style="color:transparent;">‚Ä¢</td>
                <td style="color:transparent;">‚Ä¢</td>
                <td style="color:transparent;">‚Ä¢</td>
                <td style="color:transparent;">‚Ä¢</td>
            `;
            tbody.appendChild(tr);
        }

        renderPagination(totalPages);
    }

    function renderPagination(totalPages) {
        const container = document.getElementById('pagination');
        container.innerHTML = '';

        if (!totalPages || totalPages <= 1) return;

        const createBtn = (label, page, options = {}) => {
            const btn = document.createElement('button');
            btn.textContent = label;
            btn.className = 'page-btn';
            if (options.active) btn.classList.add('active');
            btn.addEventListener('click', () => renderEmployees(page));
            container.appendChild(btn);
        };

        createBtn('¬´', Math.max(1, currentPage - 1));

        const currentBlock = Math.floor((currentPage - 1) / maxPageButtons);
        const blockStart = currentBlock * maxPageButtons + 1;
        const blockEnd = Math.min(blockStart + maxPageButtons - 1, totalPages);

        if (blockStart > 1) {
            const ellipsisPrev = document.createElement('span');
            ellipsisPrev.textContent = '...';
            ellipsisPrev.className = 'page-ellipsis';
            container.appendChild(ellipsisPrev);
        }

        for (let p = blockStart; p <= blockEnd; p++) {
            createBtn(String(p), p, { active: p === currentPage });
        }

        if (blockEnd < totalPages) {
            const ellipsisNext = document.createElement('span');
            ellipsisNext.textContent = '...';
            ellipsisNext.className = 'page-ellipsis';
            container.appendChild(ellipsisNext);
        }

        createBtn('¬ª', Math.min(totalPages, currentPage + 1));
    }

    function clearTable() {
        document.getElementById('employee-table-body').innerHTML = `
            <tr>
              <td colspan="4" style="text-align:center; color:#9ca3af;">
                ƒê√£ x√≥a d·ªØ li·ªáu hi·ªÉn th·ªã ‚Äì b·∫•m ‚ÄúT·∫£i danh s√°ch‚Äù ƒë·ªÉ xem l·∫°i.
              </td>
            </tr>`;
        document.getElementById('pagination').innerHTML = '';
        setStatusList('ƒê√£ x√≥a d·ªØ li·ªáu tr√™n UI, kh√¥ng ·∫£nh h∆∞·ªüng t·ªõi database.', 'info');
    }

    function loadEmployees() {
        setStatusList('ƒêang t·∫£i danh s√°ch nh√¢n vi√™n‚Ä¶', 'info');
        fetch(baseUrl)
            .then(r => {
                if (!r.ok) throw new Error('HTTP ' + r.status);
                return r.json();
            })
            .then(data => {
                employeesData = data || [];
                renderEmployees(1);
                setStatusList('T·∫£i danh s√°ch th√†nh c√¥ng (' + employeesData.length + ' nh√¢n vi√™n).', 'success');
            })
            .catch(err => {
                console.error(err);
                setStatusList('L·ªói khi t·∫£i danh s√°ch: ' + err.message, 'error');
            });
    }

    function addEmployee() {
        const id = Number(document.getElementById('add-id').value);
        const name = document.getElementById('add-name').value.trim();
        const salary = Number(document.getElementById('add-salary').value);

        if (!id || !name || !salary) {
            setStatusForm('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß ID, T√™n, L∆∞∆°ng cho ph·∫ßn Th√™m m·ªõi.', 'error');
            return;
        }

        const body = { id, name, salary };
        setStatusForm('ƒêang th√™m nh√¢n vi√™n‚Ä¶', 'info');

        fetch(baseUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        })
            .then(r => {
                if (!r.ok) return r.text().then(t => { throw new Error(t || 'HTTP ' + r.status); });
                return r.json();
            })
            .then(() => {
                setStatusForm('Th√™m nh√¢n vi√™n th√†nh c√¥ng.', 'success');
                loadEmployees();
            })
            .catch(err => {
                console.error(err);
                setStatusForm('L·ªói khi th√™m nh√¢n vi√™n: ' + err.message, 'error');
            });
    }

    function updateEmployee() {
        const id = Number(document.getElementById('upd-id').value);
        const name = document.getElementById('upd-name').value.trim();
        const salary = Number(document.getElementById('upd-salary').value);

        if (!id || !name || !salary) {
            setStatusForm('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß ID, T√™n m·ªõi, L∆∞∆°ng m·ªõi cho ph·∫ßn C·∫≠p nh·∫≠t.', 'error');
            return;
        }

        const body = { id, name, salary };
        setStatusForm('ƒêang c·∫≠p nh·∫≠t nh√¢n vi√™n‚Ä¶', 'info');

        fetch(baseUrl + '/' + id, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        })
            .then(r => {
                if (!r.ok) return r.text().then(t => { throw new Error(t || 'HTTP ' + r.status); });
                return r.json();
            })
            .then(() => {
                setStatusForm('C·∫≠p nh·∫≠t nh√¢n vi√™n th√†nh c√¥ng.', 'success');
                loadEmployees();
            })
            .catch(err => {
                console.error(err);
                setStatusForm('L·ªói khi c·∫≠p nh·∫≠t nh√¢n vi√™n: ' + err.message, 'error');
            });
    }

    function deleteEmployee(id) {
        if (!confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a nh√¢n vi√™n ID = " + id + " ?")) {
            return;
        }

        fetch(baseUrl + '/' + id, {
            method: 'DELETE'
        })
            .then(r => {
                if (!r.ok) return r.text().then(t => { throw new Error(t || 'HTTP ' + r.status); });
                setStatusList("ƒê√£ x√≥a nh√¢n vi√™n ID = " + id, "success");
                loadEmployees();
            })
            .catch(err => {
                console.error(err);
                setStatusList("L·ªói khi xo√° nh√¢n vi√™n: " + err.message, "error");
            });
    }
</script>

</body>
</html>
