<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>Qu·∫£n l√Ω nh√¢n vi√™n</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background: #f3f4f6;
            color: #111827;
        }

        .app-container {
            max-width: 960px;
            margin: 40px auto;
            padding: 0 16px;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .app-title {
            font-size: 24px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 13px;
            color: #6b7280;
        }

        .card {
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
        }

        button {
            border: none;
            padding: 8px 14px;
            border-radius: 999px;
            background: #2563eb;
            color: #fff;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: background 0.15s ease, transform 0.05s ease;
        }

        button:hover {
            background: #1d4ed8;
        }

        button:active {
            transform: translateY(1px);
        }

        button.secondary {
            background: #e5e7eb;
            color: #111827;
        }

        button.secondary:hover {
            background: #d1d5db;
        }

        .button-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
            font-size: 14px;
        }

        th, td {
            padding: 8px 10px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            background: #f9fafb;
            font-weight: 600;
            font-size: 13px;
            color: #6b7280;
        }

        tr:hover td {
            background: #f9fafb;
        }

        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 11px;
            background: #eff6ff;
            color: #1d4ed8;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
            margin-top: 8px;
        }

        .field {
            margin-bottom: 10px;
        }

        label {
            display: block;
            font-size: 13px;
            margin-bottom: 4px;
            color: #4b5563;
        }

        input {
            width: 100%;
            padding: 7px 10px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            font-size: 14px;
            outline: none;
            transition: border-color 0.15s ease, box-shadow 0.15s ease;
        }

        input:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.25);
        }

        .status-bar {
            margin-top: 10px;
            font-size: 13px;
            min-height: 18px;
        }

        .status--success {
            color: #15803d;
        }

        .status--error {
            color: #b91c1c;
        }

        .status--info {
            color: #4b5563;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 999px;
            background: #f9fafb;
            font-size: 12px;
            color: #6b7280;
        }

        .pill-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: #22c55e;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 6px;
            margin-top: 12px;
            font-size: 13px;
        }

        .page-btn {
            min-width: 28px;
            padding: 5px 8px;
            border-radius: 999px;
            border: none;
            background: #e5e7eb;
            color: #111827;
            cursor: pointer;
            font-size: 13px;
        }

        .page-btn.active {
            background: #2563eb;
            color: #fff;
        }

        .page-btn.disabled {
            opacity: 0.4;
            cursor: default;
        }

        .page-ellipsis {
            padding: 0 4px;
            color: #6b7280;
        }

        @media (max-width: 640px) {
            .app-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
<div class="app-container">
    <header class="app-header">
        <div>
            <div class="app-title">Employee Web Service Demo</div>
            <div class="subtitle">ƒê·ªÅ CSW ‚Äì get / add / update employee (Spring Boot + MySQL)</div>
        </div>
        <div class="pill">
            <span class="pill-dot"></span>
            <span>Server: <strong>localhost:8080</strong></span>
        </div>
    </header>

    <!-- Danh s√°ch nh√¢n vi√™n -->
    <section class="card">
        <div class="card-header">
            <div class="card-title">Danh s√°ch nh√¢n vi√™n</div>
            <div class="button-row">
                <button onclick="loadEmployees()">
                    üîÑ T·∫£i danh s√°ch
                </button>
                <button class="secondary" onclick="clearTable()">
                    üßπ X√≥a hi·ªÉn th·ªã
                </button>
            </div>
        </div>

        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>T√™n nh√¢n vi√™n</th>
                <th>L∆∞∆°ng</th>
            </tr>
            </thead>
            <tbody id="employee-table-body">
            <tr>
                <td colspan="3" style="text-align:center; color:#9ca3af; font-size:13px;">
                    Ch∆∞a c√≥ d·ªØ li·ªáu ‚Äì b·∫•m ‚ÄúT·∫£i danh s√°ch‚Äù.
                </td>
            </tr>
            </tbody>
        </table>

        <!-- Ph√¢n trang -->
        <div id="pagination" class="pagination"></div>

        <div id="status-list" class="status-bar status--info">
            ƒêang ch·ªù thao t√°c‚Ä¶
        </div>
    </section>

    <!-- Form th√™m / c·∫≠p nh·∫≠t -->
    <section class="card">
        <div class="card-header">
            <div class="card-title">Th√™m / C·∫≠p nh·∫≠t nh√¢n vi√™n</div>
            <span class="badge">POST / PUT ‚Üí /api/employees</span>
        </div>

        <div class="grid">
            <!-- Form th√™m -->
            <div>
                <h4 style="margin: 0 0 8px; font-size: 15px;">Th√™m m·ªõi</h4>
                <div class="field">
                    <label for="add-id">ID *</label>
                    <input id="add-id" type="number" placeholder="V√≠ d·ª•: 1" />
                </div>
                <div class="field">
                    <label for="add-name">T√™n *</label>
                    <input id="add-name" type="text" placeholder="V√≠ d·ª•: Nguyen Van A" />
                </div>
                <div class="field">
                    <label for="add-salary">L∆∞∆°ng *</label>
                    <input id="add-salary" type="number" step="0.01" placeholder="V√≠ d·ª•: 1000" />
                </div>
                <button onclick="addEmployee()">‚ûï Th√™m nh√¢n vi√™n</button>
            </div>

            <!-- Form c·∫≠p nh·∫≠t -->
            <div>
                <h4 style="margin: 0 0 8px; font-size: 15px;">C·∫≠p nh·∫≠t</h4>
                <div class="field">
                    <label for="upd-id">ID c·∫ßn s·ª≠a *</label>
                    <input id="upd-id" type="number" placeholder="Nh·∫≠p ƒë√∫ng ID ƒë√£ t·ªìn t·∫°i" />
                </div>
                <div class="field">
                    <label for="upd-name">T√™n m·ªõi *</label>
                    <input id="upd-name" type="text" placeholder="T√™n m·ªõi" />
                </div>
                <div class="field">
                    <label for="upd-salary">L∆∞∆°ng m·ªõi *</label>
                    <input id="upd-salary" type="number" step="0.01" placeholder="L∆∞∆°ng m·ªõi" />
                </div>
                <button onclick="updateEmployee()">‚úèÔ∏è C·∫≠p nh·∫≠t nh√¢n vi√™n</button>
            </div>
        </div>

        <div id="status-form" class="status-bar status--info">
            ƒêi·ªÅn ƒë·∫ßy ƒë·ªß c√°c tr∆∞·ªùng * r·ªìi b·∫•m Th√™m / C·∫≠p nh·∫≠t.
        </div>
    </section>
</div>

<script>
    const baseUrl = '/api/employees';

    // d·ªØ li·ªáu + c·∫•u h√¨nh ph√¢n trang
    let employeesData = [];
    let currentPage = 1;
    const pageSize = 5;
    const maxPageButtons = 3; // ch·ªâ hi·ªán 3 trang, sau ƒë√≥ l√† ...

    function setStatusList(message, type = 'info') {
        const status = document.getElementById('status-list');
        status.textContent = message;
        status.className = 'status-bar status--' + type;
    }

    function setStatusForm(message, type = 'info') {
        const status = document.getElementById('status-form');
        status.textContent = message;
        status.className = 'status-bar status--' + type;
    }

    function renderEmployees(page = 1) {
        const tbody = document.getElementById('employee-table-body');
        tbody.innerHTML = '';

        if (!employeesData || employeesData.length === 0) {
            tbody.innerHTML = `
      <tr>
        <td colspan="3" style="text-align:center; color:#9ca3af; font-size:13px;">
          Kh√¥ng c√≥ nh√¢n vi√™n n√†o trong h·ªá th·ªëng.
        </td>
      </tr>`;
            document.getElementById('pagination').innerHTML = '';
            return;
        }

        const totalPages = Math.ceil(employeesData.length / pageSize);
        if (page < 1) page = 1;
        if (page > totalPages) page = totalPages;
        currentPage = page;

        const startIndex = (page - 1) * pageSize;
        const endIndex = startIndex + pageSize;
        const pageItems = employeesData.slice(startIndex, endIndex);

        // c√°c d√≤ng c√≥ d·ªØ li·ªáu
        pageItems.forEach(emp => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
      <td>${emp.id}</td>
      <td>${emp.name}</td>
      <td>${emp.salary}</td>
    `;
            tbody.appendChild(tr);
        });

        // ƒë·ªám th√™m d√≤ng tr·ªëng ƒë·ªÉ lu√¥n ƒë·ªß 5 d√≤ng / trang
        const remaining = pageSize - pageItems.length;
        for (let i = 0; i < remaining; i++) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
      <td style="height:32px; color:transparent;">‚Ä¢</td>
      <td style="color:transparent;">‚Ä¢</td>
      <td style="color:transparent;">‚Ä¢</td>
    `;
            tbody.appendChild(tr);
        }

        renderPagination(totalPages);
    }


    function renderPagination(totalPages) {
        const container = document.getElementById('pagination');
        container.innerHTML = '';

        if (!totalPages || totalPages <= 1) return;

        const createBtn = (label, page, options = {}) => {
            const btn = document.createElement('button');
            btn.textContent = label;
            btn.className = 'page-btn';
            if (options.active) btn.classList.add('active');
            if (options.disabled) {
                btn.classList.add('disabled');
            } else {
                btn.addEventListener('click', () => renderEmployees(page));
            }
            container.appendChild(btn);
        };

        // n√∫t Prev
        createBtn('¬´', currentPage - 1, { disabled: currentPage === 1 });

        const totalBlocks = Math.ceil(totalPages / maxPageButtons);
        const currentBlock = Math.floor((currentPage - 1) / maxPageButtons);
        const blockStart = currentBlock * maxPageButtons + 1;
        const blockEnd = Math.min(blockStart + maxPageButtons - 1, totalPages);

        if (blockStart > 1) {
            const ellipsisPrev = document.createElement('span');
            ellipsisPrev.textContent = '...';
            ellipsisPrev.className = 'page-ellipsis';
            container.appendChild(ellipsisPrev);
        }

        for (let p = blockStart; p <= blockEnd; p++) {
            createBtn(String(p), p, { active: p === currentPage });
        }

        if (blockEnd < totalPages) {
            const ellipsisNext = document.createElement('span');
            ellipsisNext.textContent = '...';
            ellipsisNext.className = 'page-ellipsis';
            container.appendChild(ellipsisNext);
        }

        // n√∫t Next
        createBtn('¬ª', currentPage + 1, { disabled: currentPage === totalPages });
    }

    function clearTable() {
        document.getElementById('employee-table-body').innerHTML = `
      <tr>
        <td colspan="3" style="text-align:center; color:#9ca3af; font-size:13px;">
          ƒê√£ x√≥a d·ªØ li·ªáu hi·ªÉn th·ªã ‚Äì b·∫•m ‚ÄúT·∫£i danh s√°ch‚Äù ƒë·ªÉ xem l·∫°i.
        </td>
      </tr>`;
        document.getElementById('pagination').innerHTML = '';
        setStatusList('ƒê√£ x√≥a d·ªØ li·ªáu tr√™n UI, kh√¥ng ·∫£nh h∆∞·ªüng t·ªõi database.', 'info');
    }

    function loadEmployees() {
        setStatusList('ƒêang t·∫£i danh s√°ch nh√¢n vi√™n‚Ä¶', 'info');
        fetch(baseUrl)
            .then(r => {
                if (!r.ok) throw new Error('HTTP ' + r.status);
                return r.json();
            })
            .then(data => {
                employeesData = data || [];
                renderEmployees(1);
                setStatusList('T·∫£i danh s√°ch th√†nh c√¥ng (' + employeesData.length + ' nh√¢n vi√™n).', 'success');
            })
            .catch(err => {
                console.error(err);
                setStatusList('L·ªói khi t·∫£i danh s√°ch: ' + err.message, 'error');
            });
    }

    function addEmployee() {
        const id = Number(document.getElementById('add-id').value);
        const name = document.getElementById('add-name').value.trim();
        const salary = Number(document.getElementById('add-salary').value);

        if (!id || !name || !salary) {
            setStatusForm('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß ID, T√™n, L∆∞∆°ng cho ph·∫ßn Th√™m m·ªõi.', 'error');
            return;
        }

        const body = { id, name, salary };

        setStatusForm('ƒêang th√™m nh√¢n vi√™n‚Ä¶', 'info');
        fetch(baseUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        })
            .then(r => {
                if (!r.ok) return r.text().then(t => { throw new Error(t || 'HTTP ' + r.status); });
                return r.json();
            })
            .then(() => {
                setStatusForm('Th√™m nh√¢n vi√™n th√†nh c√¥ng.', 'success');
                loadEmployees();
            })
            .catch(err => {
                console.error(err);
                setStatusForm('L·ªói khi th√™m nh√¢n vi√™n: ' + err.message, 'error');
            });
    }

    function updateEmployee() {
        const id = Number(document.getElementById('upd-id').value);
        const name = document.getElementById('upd-name').value.trim();
        const salary = Number(document.getElementById('upd-salary').value);

        if (!id || !name || !salary) {
            setStatusForm('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß ID, T√™n m·ªõi, L∆∞∆°ng m·ªõi cho ph·∫ßn C·∫≠p nh·∫≠t.', 'error');
            return;
        }

        const body = { id, name, salary };

        setStatusForm('ƒêang c·∫≠p nh·∫≠t nh√¢n vi√™n‚Ä¶', 'info');
        fetch(baseUrl + '/' + id, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        })
            .then(r => {
                if (!r.ok) return r.text().then(t => { throw new Error(t || 'HTTP ' + r.status); });
                return r.json();
            })
            .then(() => {
                setStatusForm('C·∫≠p nh·∫≠t nh√¢n vi√™n th√†nh c√¥ng.', 'success');
                loadEmployees();
            })
            .catch(err => {
                console.error(err);
                setStatusForm('L·ªói khi c·∫≠p nh·∫≠t nh√¢n vi√™n: ' + err.message, 'error');
            });
    }
</script>
</body>
</html>
